generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int                 @id @default(autoincrement())
  email             String              @unique
  password          String
  name              String
  role              String              @default("user") // "user" or "admin"
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  projectSubmissions ProjectSubmission[]
  courseRegistrations CourseRegistration[]
}

model ProjectSubmission {
  id           Int      @id @default(autoincrement())
  userId       Int?
  user         User?    @relation(fields: [userId], references: [id], onDelete: Cascade)
  name         String
  email        String
  company      String?
  projectType  String?
  budgetRange  String?
  timeline     String?
  description  String
  fileUrl      String?
  status       String   @default("pending") // "pending", "in_progress", "completed", "rejected"
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model CourseRegistration {
  id                Int      @id @default(autoincrement())
  userId            Int?
  user              User?    @relation(fields: [userId], references: [id], onDelete: Cascade)
  courseId          String
  name              String
  email             String
  phone             String?
  experienceLevel   String?
  preferredSchedule String?
  message           String?
  paymentReceiptUrl String?
  status            String   @default("pending_payment") // "pending_payment", "pending_verification", "approved", "rejected", "completed"
  verifiedAt        DateTime?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model CourseSchedule {
  id          Int      @id @default(autoincrement())
  courseId    String
  title       String
  description String?
  startDate   DateTime
  endDate     DateTime
  duration    Int      // Duration in months
  schedule    String   // JSON string or text describing the schedule
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([courseId])
}
